{
  "type": "record",
  "name": "CurrentState",
  "namespace": "com.datamesh.agent.state",
  "doc": "Aggregated current state of the entire data platform (deployment + usage + metrics)",
  "fields": [
    {
      "name": "timestamp",
      "type": "string",
      "doc": "ISO 8601 timestamp of when this aggregated state was created"
    },
    {
      "name": "deployment",
      "type": {
        "type": "record",
        "name": "DeploymentSnapshot",
        "fields": [
          {"name": "timestamp", "type": "string"},
          {"name": "cluster_id", "type": "string"},
          {"name": "total_topics", "type": "int"},
          {"name": "total_schemas", "type": "int"},
          {"name": "total_connectors", "type": "int"},
          {"name": "domain_count", "type": "int"}
        ]
      },
      "doc": "Summary of deployment state"
    },
    {
      "name": "usage",
      "type": {
        "type": "record",
        "name": "UsageSnapshot",
        "fields": [
          {"name": "timestamp", "type": "string"},
          {"name": "consumer_groups", "type": "int"},
          {"name": "active_consumers", "type": "int"},
          {"name": "idle_topic_count", "type": "int"}
        ]
      },
      "doc": "Summary of usage state"
    },
    {
      "name": "metrics",
      "type": {
        "type": "record",
        "name": "MetricsSnapshot",
        "fields": [
          {"name": "timestamp", "type": "string"},
          {"name": "total_throughput_mbps", "type": "float"},
          {"name": "avg_latency_ms", "type": "float"},
          {"name": "error_rate", "type": "float"},
          {"name": "topics_with_lag_count", "type": "int"}
        ]
      },
      "doc": "Summary of metrics state"
    },
    {
      "name": "summary",
      "type": "string",
      "doc": "Human-readable summary generated by Claude, synthesizing all three states"
    },
    {
      "name": "notable_observations",
      "type": {
        "type": "array",
        "items": "string"
      },
      "default": [],
      "doc": "Key insights or anomalies identified by the Current State Prompt agent"
    }
  ]
}
